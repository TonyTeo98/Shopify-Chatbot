# 自建 vs 使用开源项目：决策分析

> 当 Shopify MCP 功能不够用时，应该舍弃开源项目自建，还是在其基础上扩展？

---

## 一、问题背景

在调研这个开源项目时，发现一个关键问题：

**Shopify MCP 提供的功能有限**，而电商客服涉及的场景很多：
- 订单追踪（需要实时物流信息）
- 产品推荐（需要推荐算法）
- 退换货（需要完整售后流程）
- 客户支持（需要工单系统）
- 会员积分、优惠券等

那么，是否应该舍弃这个开源项目，自己设计一套？

---

## 二、这个项目的核心价值分析

### 2.1 组件可复用性评估

| 组件 | 可复用性 | 自建难度 | 说明 |
|------|---------|---------|------|
| 前端聊天 UI | 高 | 低（1-2天） | 通用组件，可直接复用 |
| SSE 流式传输 | 高 | 中（半天） | 标准技术，容易实现 |
| Claude API 集成 | 高 | 低（几小时） | 官方 SDK 很完善 |
| 会话管理 | 高 | 低（几小时） | 数据库 CRUD |
| **Shopify MCP 集成** | **核心价值** | **无法自建** | Shopify 官方服务 |

### 2.2 关键认知：MCP 是什么？

**MCP 不是这个项目的代码，而是 Shopify 官方提供的 API 服务**

```
你的代码 ──► Shopify MCP API ──► Shopify 后台数据
              (Shopify 托管)      (产品、订单、购物车)
```

**你无法自建 MCP**，因为它是 Shopify 访问店铺数据的官方通道。

如果不用 MCP，你需要：
1. 自己实现 Shopify OAuth
2. 自己调用 Shopify Admin API
3. 自己处理各种数据格式转换
4. 自己维护 API 版本兼容性

---

## 三、MCP 功能边界分析

### 3.1 Shopify MCP 目前提供的能力

| 功能 | 工具名称 | 说明 |
|------|---------|------|
| 产品搜索 | `search_shop_catalog` | 支持关键词搜索 |
| 购物车操作 | `update_cart`, `get_cart` | 添加、删除、查看 |
| 政策/FAQ 查询 | `search_shop_policies_and_faqs` | 店铺政策 |
| 订单查询 | `get_order_status`, `get_most_recent_order_status` | 基础订单信息 |
| 退货发起 | Customer MCP | 需要用户登录 |

### 3.2 电商客服常见需求 vs 实现方式

| 需求 | MCP 支持？ | 替代方案 |
|------|-----------|---------|
| 产品搜索 | ✅ | - |
| 产品推荐 | ⚠️ 只有搜索 | 接入推荐算法增强 |
| 购物车管理 | ✅ | - |
| 订单状态 | ✅ | - |
| **实时物流追踪** | ❌ 只有发货状态 | 第三方物流 API（17Track、快递100） |
| **库存查询** | ❌ | Shopify Admin API |
| **优惠券查询** | ❌ | Shopify Admin API |
| **会员积分** | ❌ | 自建服务或第三方 |
| **售后工单** | ❌ | 接入 Zendesk/Freshdesk |
| **人工转接** | ❌ | 自建逻辑 |

### 3.3 结论

MCP 覆盖了 **基础购物场景**（搜索、购物车、订单），但 **高级功能需要自己扩展**。

---

## 四、决策建议：不要舍弃，而是扩展

### 4.1 推荐架构

```
┌─────────────────────────────────────────────────────────────┐
│                     AI 客服系统架构                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   Claude AI (大脑) ─── 统一工具调度                          │
│      │                                                      │
│      ├──► Shopify MCP                                       │
│      │    └─ 产品搜索、购物车、订单基础信息                    │
│      │                                                      │
│      ├──► Shopify Admin API (自建工具)                       │
│      │    └─ 库存查询、优惠券、详细订单信息                    │
│      │                                                      │
│      ├──► 物流 API (自建工具)                                │
│      │    └─ 17Track / 快递100 / 各快递公司 API              │
│      │                                                      │
│      ├──► 客服系统 API (自建工具)                            │
│      │    └─ Zendesk / Freshdesk / 自建工单系统              │
│      │                                                      │
│      └──► 业务系统 API (自建工具)                            │
│           └─ 会员积分、推荐算法、营销活动等                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4.2 代码层面的扩展方式

```javascript
// 统一工具管理
const allTools = [
  ...shopifyMcpTools,      // 来自 Shopify MCP（开箱即用）
  ...shopifyAdminTools,    // 自建：调用 Shopify Admin API
  ...shippingTools,        // 自建：物流追踪
  ...customerServiceTools, // 自建：工单、人工转接
  ...customTools           // 自建：会员、积分等
];

// Claude 会根据用户问题自动选择合适的工具
```

### 4.3 这个开源项目提供的价值

即使 MCP 功能有限，这个项目仍然提供了：

1. **现成的框架**
   - 前端聊天 UI（响应式、移动端适配）
   - SSE 流式传输（实时显示 AI 回复）
   - 会话管理（对话历史持久化）

2. **Claude 工具调用机制**
   - 已实现的 tool_use 循环
   - 工具结果处理
   - 错误处理

3. **Shopify App 集成**
   - OAuth 认证流程
   - Session 管理
   - Theme Extension 注入

4. **MCP 客户端参考**
   - JSON-RPC 通信
   - 可作为扩展其他 API 的参考

---

## 五、完全自建的工作量评估

如果完全舍弃这个项目，从零开始：

| 模块 | 工作量 | 说明 |
|------|--------|------|
| 前端聊天 UI | 2-3 天 | 或使用开源组件 |
| 后端 API 框架 | 1-2 天 | Node.js / Python |
| Claude API 集成 | 1 天 | 官方 SDK |
| 流式传输 (SSE) | 0.5 天 | 标准实现 |
| Shopify 数据访问 | 3-5 天 | Admin API + OAuth |
| 物流 API 集成 | 1-2 天 | 第三方服务 |
| 客服系统集成 | 2-3 天 | Zendesk 等 |
| 会话管理 | 1 天 | 数据库设计 |
| 测试和调试 | 2-3 天 | - |
| **总计** | **14-20 天** | 基础版本 |

**使用这个开源项目 + 扩展**：
- 理解代码：1-2 天
- 扩展工具：按需添加（每个工具 0.5-1 天）
- **总计**：3-5 天可以有一个增强版本

---

## 六、决策矩阵

| 选择 | 优点 | 缺点 | 适合场景 |
|------|------|------|---------|
| **使用开源项目 + 扩展** | 快速启动、MCP 开箱即用、框架成熟 | 受限于项目架构 | Shopify 店铺、快速验证、资源有限 |
| **完全自建** | 完全控制、架构灵活 | 工作量大、需要维护 | 非 Shopify 平台、特殊需求、团队充足 |
| **混合方案** | 复用框架、替换数据源 | 需要深入理解代码 | 多平台支持、渐进式迁移 |

---

## 七、最终建议

### 7.1 短期策略（1-2 周）

1. **先把项目跑起来**，体验 MCP 的实际能力边界
2. **记录功能缺口**，明确哪些需求 MCP 无法满足
3. **评估扩展成本**，每个缺失功能需要多少工作量

### 7.2 中期策略（1-2 月）

1. **在现有框架上扩展**，添加自定义工具
2. **优先实现高频需求**（如物流追踪）
3. **收集用户反馈**，迭代优化

### 7.3 长期策略（3-6 月）

1. **评估是否需要重构**，基于实际运营数据
2. **考虑多平台支持**，如果业务扩展到非 Shopify 平台
3. **建立自己的工具库**，形成可复用的客服 AI 能力

---

## 八、关键结论

> **不要因为 MCP 功能有限就舍弃这个项目。**
>
> MCP 提供的是 **基础能力**，而这个项目提供的是 **完整框架**。
>
> 正确的做法是：**复用框架 + 扩展工具**。

这就像盖房子：
- MCP = 水电煤（基础设施，必须用官方的）
- 开源项目 = 毛坯房（框架结构，可以直接住）
- 自建工具 = 装修（按需定制）

你不会因为毛坯房没有装修就把整栋楼拆了重建，而是在现有基础上装修。

---

## 九、下一步行动

1. **运行项目**：`npm install && npm run dev`
2. **体验 MCP**：测试各种对话场景
3. **记录缺口**：哪些问题 AI 回答不了
4. **规划扩展**：优先级排序，逐步实现
